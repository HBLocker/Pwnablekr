```bash
000000 ;
.text:08000000 ; Input SHA256 : D2C426CB8CFBDCDB026BDB9551F484CC074177AB26D98D13522486DF09F7ADC6
.text:08000000 ; Input MD5    : 70F8549A69B52D35924C16200E63FAA9
.text:08000000 ; Input CRC32  : F6FE10E4
.text:08000000
.text:08000000 ; File Name   : Z:\home\harry\pwnble\rootkit\rootkit
.text:08000000 ; Format      : ELF for Intel 386 (Relocatable)
.text:08000000 ;
.text:08000000
.text:08000000                 .686p
.text:08000000                 .mmx
.text:08000000                 .model flat
.text:08000000 .intel_syntax noprefix
.text:08000000


The program hooks sys calls with the following functions:
sys_renameat_hooked	.text	0000000008000000	0000004D	00000014	0000000C	R	.	.	.	.	B	.	.

sys_rename_hooked	.text	0000000008000050	00000046	00000010	00000008	R	.	.	.	.	B	.	.

sys_linkat_hooked	.text	00000000080000A0	00000054	00000018	00000010	R	.	.	.	.	B	.	.

sys_link_hooked	.text	0000000008000100	00000046	00000010	00000008	R	.	.	.	.	B	.	.

sys_symlinkat_hooked	.text	0000000008000150	0000004D	00000014	0000000C	R	.	.	.	.	B	.	.

sys_symlink_hooked	.text	00000000080001A0	00000046	00000010	00000008	R	.	.	.	.	B	.	.

sys_symlink_hooked	.text	00000000080001A0	00000046	00000010	00000008	R	.	.	.	.	B	.	.

sys_open_hooked	.text	0000000008000250	0000004D	00000014	0000000C	R	.	.	.	.	B	.	.


when revoewing the decompiled code the functions ll have paths t the flag or at least have some mention to it :S 

soooo.........
as we are logged into the server as root, we will need to do some Kenrel fuckery!

so I had to download kernel files formt he wasback machine then reverse ssh them to the session. 
once they are made make them... 
total 148
drwxrwxr-x 3 doublesine doublesine  4096 Feb 22 01:28 .
drwxr-xr-x 3 doublesine doublesine  4096 Feb 21 23:58 ..
-rw-rw-r-- 1 doublesine doublesine 47114 Feb 21 23:38 .cache.mk
-rw-rw-r-- 1 doublesine doublesine   161 Feb 21 23:52 Makefile
-rw-rw-r-- 1 doublesine doublesine    47 Feb 22 01:28 modules.order
-rw-rw-r-- 1 doublesine doublesine     0 Feb 22 01:28 Module.symvers
-rw-rw-r-- 1 doublesine doublesine   592 Feb 22 00:55 solve.c
-rw-rw-r-- 1 doublesine doublesine  2248 Feb 22 01:28 solve.ko
-rw-rw-r-- 1 doublesine doublesine   275 Feb 22 01:28 .solve.ko.cmd
-rw-rw-r-- 1 doublesine doublesine   663 Feb 22 01:28 solve.mod.c
-rw-rw-r-- 1 doublesine doublesine  1764 Feb 22 01:28 solve.mod.o
-rw-rw-r-- 1 doublesine doublesine 28195 Feb 22 01:28 .solve.mod.o.cmd
-rw-rw-r-- 1 doublesine doublesine  1460 Feb 22 01:28 solve.o
-rw-rw-r-- 1 doublesine doublesine 28092 Feb 22 01:28 .solve.o.cmd

Now we do this....
base64 ./solve.ko
f0VMRgEBAQAAAAAAAAAAAAEAAwABAAAAAAAAAAAAAAAgBgAAAAAAADQAAAAAACgAEQAOAAQAAAAU
AAAAAwAAAEdOVQDg82MWvvmFraAIxHhpiLY0t0wxRAAAAAAAAAAAVYnl6Pz////6DyDAJf///v8P
IsDHBTSgX8FwjRXBDyDADQAAAQAPIsD7McBdw2aQVYnl6Pz///9dwwAAAwAAADMAAABzcmN2ZXJz
aW9uPUVCRDlGNjk3NUE0QkI1QkRDRDA2QTJEAGRlcGVuZHM9AHZlcm1hZ2ljPTMuNy4xLTAzMDcw
MS1nZW5lcmljIFNNUCBtb2RfdW5sb2FkIG1vZHZlcnNpb25zIDY4NiAAAAAAAAAAAAAAAAAAAAAA
AAAAiI2b021vZHVsZV9sYXlvdXQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAJoPObRtY291bnQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABzb2x2ZQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAR0NDOiAoVWJ1bnR1L0xpbmFybyA0LjcuNC0zdWJ1bnR1MTIpIDQuNy40AABHQ0M6IChVYnVu
dHUvTGluYXJvIDQuNy40LTN1YnVudHUxMikgNC43LjQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAMAAQAAAAAAAAAAAAAAAAADAAIAAAAAAAAAAAAAAAAAAwAEAAAAAAAAAAAAAAAAAAMABgAA
AAAAAAAAAAAAAAADAAcAAAAAAAAAAAAAAAAAAwAIAAAAAAAAAAAAAAAAAAMACQAAAAAAAAAAAAAA
AAADAAsAAAAAAAAAAAAAAAAAAwAMAAAAAAAAAAAAAAAAAAMADQABAAAAAAAAAAAAAAAEAPH/CQAA
AAAAAAAAAAAABADx/xUAAAAAAAAAIwAAAAEABgAoAAAAIwAAAAkAAAABAAYAOQAAAAAAAACAAAAA
AQAHAEYAAAAsAAAAPgAAAAEABgBWAAAAAAAAAIABAAARAAkAZAAAADAAAAAKAAAAEgACAHMAAAAA
AAAALgAAABIAAgB/AAAAAAAAAAAAAAAQAAAAAHNvbHZlLmMAc29sdmUubW9kLmMAX19tb2Rfc3Jj
dmVyc2lvbjMwAF9fbW9kdWxlX2RlcGVuZHMAX19fX3ZlcnNpb25zAF9fbW9kX3Zlcm1hZ2ljNQBf
X3RoaXNfbW9kdWxlAGNsZWFudXBfbW9kdWxlAGluaXRfbW9kdWxlAG1jb3VudAAAAAQAAAACFAAA
NAAAAAIUAAAAAAAAAQIAAAQAAAABAgAA2AAAAAETAAB4AQAAARIAAAAuc3ltdGFiAC5zdHJ0YWIA
LnNoc3RydGFiAC5ub3RlLmdudS5idWlsZC1pZAAucmVsLnRleHQALnJlbF9fbWNvdW50X2xvYwAu
bW9kaW5mbwBfX3ZlcnNpb25zAC5kYXRhAC5yZWwuZ251LmxpbmtvbmNlLnRoaXNfbW9kdWxlAC5i
c3MALmNvbW1lbnQALm5vdGUuR05VLXN0YWNrAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAGwAAAAcAAAACAAAAAAAAADQAAAAkAAAAAAAAAAAAAAAEAAAAAAAAADIAAAAB
AAAABgAAAAAAAABgAAAAOgAAAAAAAAAAAAAAEAAAAAAAAAAuAAAACQAAAEAAAAAAAAAAUAUAABAA
AAAPAAAAAgAAAAQAAAAIAAAAPAAAAAEAAAACAAAAAAAAAJwAAAAIAAAAAAAAAAAAAAAEAAAAAAAA
ADgAAAAJAAAAQAAAAAAAAABgBQAAEAAAAA8AAAAEAAAABAAAAAgAAABJAAAAAQAAAAIAAAAAAAAA
pAAAAGoAAAAAAAAAAAAAAAEAAAAAAAAAUgAAAAEAAAACAAAAAAAAACABAACAAAAAAAAAAAAAAAAg
AAAAAAAAAF0AAAABAAAAAwAAAAAAAACgAQAAAAAAAAAAAAAAAAAAAQAAAAAAAABnAAAAAQAAAAMA
AAAAAAAAoAEAAIABAAAAAAAAAAAAACAAAAAAAAAAYwAAAAkAAABAAAAAAAAAAHAFAAAQAAAADwAA
AAkAAAAEAAAACAAAAIEAAAAIAAAAAwAAAAAAAAAgAwAAAAAAAAAAAAAAAAAAAQAAAAAAAACGAAAA
AQAAADAAAAAAAAAAIAMAAFgAAAAAAAAAAAAAAAEAAAABAAAAjwAAAAEAAAAAAAAAAAAAAHgDAAAA
AAAAAAAAAAAAAAABAAAAAAAAABEAAAADAAAAAAAAAAAAAACABQAAnwAAAAAAAAAAAAAAAQAAAAAA
AAABAAAAAgAAAAAAAAAAAAAAeAMAAFABAAAQAAAAEQAAAAQAAAAQAAAACQAAAAMAAAAAAAAAAAAA
AMgEAACGAAAAAAAAAAAAAAABAAAAAAAAAA==

cat the flag

cat > flag.b64


base64 -d ./flag.b64 > ./flag

binwalk ./flag

zip n unzip 

flag


